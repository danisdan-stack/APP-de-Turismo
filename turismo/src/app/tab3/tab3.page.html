<ion-content [fullscreen]="true">
  <div class="profile-header ion-padding">
    <h1>Mi Perfil</h1>
    <p>Gestiona tu informaci√≥n personal</p>
  </div>

  <div id="container" *ngIf="!loading; else loadingTemplate">
    <ion-card *ngIf="userProfile">
      <ion-card-header>
        <ion-card-title>
          {{ userProfile.firstName }} {{ userProfile.lastName }}
        </ion-card-title>
        <ion-card-subtitle>{{ userProfile.email }}</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <form (ngSubmit)="saveProfile()" *ngIf="isEditing && editedProfile; else viewTemplate">
          <!-- Nombre -->
          <ion-item>
            <ion-label position="stacked">Nombre</ion-label>
            <ion-input 
              [(ngModel)]="editedProfile.firstName" 
              name="firstName"
              type="text"
              required>
            </ion-input>
          </ion-item>

          <!-- Apellido -->
          <ion-item>
            <ion-label position="stacked">Apellido</ion-label>
            <ion-input 
              [(ngModel)]="editedProfile.lastName" 
              name="lastName"
              type="text"
              required>
            </ion-input>
          </ion-item>

          <!-- Tel√©fono -->
          <ion-item>
            <ion-label position="stacked">Tel√©fono</ion-label>
            <ion-input 
              [(ngModel)]="editedProfile.phoneNumber" 
              name="phoneNumber"
              type="tel"
              placeholder="+54 11 1234-5678">
            </ion-input>
          </ion-item>

          <!-- Email (solo lectura) -->
          <ion-item>
            <ion-label position="stacked">Email</ion-label>
            <ion-input 
              [value]="editedProfile.email" 
              type="email"
              readonly
              disabled>
            </ion-input>
          </ion-item>

          <!-- Inter√©s tur√≠stico -->
          <ion-item>
            <ion-label position="stacked">Inter√©s Tur√≠stico</ion-label>
            <ion-textarea 
              [(ngModel)]="editedProfile.tourismInterest" 
              name="tourismInterest"
              rows="3"
              placeholder="Buscando turismo en Buenos Aires...">
            </ion-textarea>
          </ion-item>

          <!-- Botones edici√≥n -->
          <div class="button-group">
            <ion-button expand="block" type="submit" color="primary">
              Guardar Cambios
            </ion-button>
            <ion-button expand="block" fill="outline" (click)="cancelEditing()">
              Cancelar
            </ion-button>
          </div>
        </form>

        <ng-template #viewTemplate>
          <!-- Vista de solo lectura -->
          <ion-list lines="none">
            <ion-item>
              <ion-label>
                <h3>Nombre</h3>
                <p>{{ userProfile.firstName || 'No especificado' }}</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-label>
                <h3>Apellido</h3>
                <p>{{ userProfile.lastName || 'No especificado' }}</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-label>
                <h3>Tel√©fono</h3>
                <p>{{ userProfile.phoneNumber || 'No especificado' }}</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-label>
                <h3>Email</h3>
                <p>{{ userProfile.email }}</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-label>
                <h3>Inter√©s Tur√≠stico</h3>
                <p>{{ userProfile.tourismInterest || 'Buscando turismo en Buenos Aires...' }}</p>
              </ion-label>
            </ion-item>
          </ion-list>

          <!-- Botones -->
          <div class="button-group">
            <ion-button expand="block" (click)="enableEditing()">
              <ion-icon slot="start" name="create-outline"></ion-icon>
              Editar Perfil
            </ion-button>
            <ion-button expand="block" fill="outline" color="danger" (click)="logout()">
              <ion-icon slot="start" name="log-out-outline"></ion-icon>
              Cerrar Sesi√≥n
            </ion-button>
          </div>
        </ng-template>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="!userProfile">
      <ion-card-content>
        <p>No se pudo cargar el perfil del usuario.</p>
        <ion-button expand="block" (click)="loadUserProfile()">
          Reintentar
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <ng-template #loadingTemplate>
    <div class="ion-text-center ion-padding">
      <ion-spinner></ion-spinner>
      <p>Cargando perfil...</p>
    </div>
  </ng-template>
</ion-content>

<!-- üîπ NAVEGACI√ìN DE TABS EN LA PARTE INFERIOR -->
<ion-tabs class="custom-tabs">
  <ion-tab-bar slot="bottom" class="tabs-navigation">
    <ion-tab-button tab="tab1" (click)="irATab1()">
      <ion-icon name="home-outline"></ion-icon>
      <ion-label>Inicio</ion-label>
    </ion-tab-button>
    
    <ion-tab-button tab="tab2" (click)="irATab2()">
      <ion-icon name="search-outline"></ion-icon>
      <ion-label>Favoritos</ion-label>
    </ion-tab-button>
    
    <ion-tab-button tab="tab3" (click)="irATab3()" class="tab-active">
      <ion-icon name="person-outline"></ion-icon>
      <ion-label>Mi Cuenta</ion-label>
    </ion-tab-button>
  </ion-tab-bar>
</ion-tabs>